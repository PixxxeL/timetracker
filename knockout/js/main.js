var TIMETRACKER, formatMilliseconds;

TIMETRACKER = {
  Settings: {
    dataStorageKey: 'timetracker-data'
  },
  Data: {
    current: 'Default',
    data: {
      'Default': []
    }
  }
};

formatMilliseconds = function(ms) {
  var hours, minutes, seconds;
  ms = (ms * .001) | 0;
  seconds = ms % 60;
  minutes = ((ms / 60) % 60) | 0;
  hours = (ms / 60 / 60) | 0;
  if (seconds < 10) {
    seconds = "0" + seconds;
  }
  if (minutes < 10) {
    minutes = "0" + minutes;
  }
  return hours + ":" + minutes + ":" + seconds;
};

TIMETRACKER.AppViewModel = function() {
  var bindEvents, load, newTimeSave, renderFrame, save, self;
  self = this;
  self.loopCounter = 0;
  self.data = ko.observable(TIMETRACKER.Data.data);
  self.titles = ko.computed(function() {
    return _.keys(self.data());
  });
  self.current = ko.observable(TIMETRACKER.Data.current);
  self.isSelectProject = ko.observable(false);
  self.isToggleProject = ko.computed(function() {
    return self.titles().length > 1;
  });
  self.diff = ko.observable(0);
  self.currentTimes = ko.computed(function() {
    return self.data()[self.current()] || [];
  });
  self.currentTimesSize = ko.computed(function() {
    return self.currentTimes().length;
  });
  self.totalTime = ko.computed(function() {
    return _.reduce(self.currentTimes(), function(memo, time) {
      return memo + (time.endTs - time.startTs);
    }, 0);
  });
  self.closedTime = ko.computed(function() {
    return _.reduce(self.currentTimes(), function(memo, time) {
      var diff;
      diff = time.closed ? 0 : time.endTs - time.startTs;
      return memo + diff;
    }, 0);
  });
  self.newTime = ko.observable(null);
  load = function() {
    var data;
    data = window.localStorage.getItem(TIMETRACKER.Settings.dataStorageKey);
    if (data) {
      data = JSON.parse(data);
      self.data(data.data);
      self.current(data.current);
    }
    return null;
  };
  save = function() {
    var data;
    data = JSON.stringify({
      current: self.current(),
      data: self.data()
    });
    window.localStorage.setItem(TIMETRACKER.Settings.dataStorageKey, data);
    return null;
  };
  bindEvents = function() {
    document.addEventListener('mouseup', function(e) {
      var button, select;
      select = document.querySelector('select.select-project');
      button = document.querySelector('a.swap-project');
      if (!select.contains(e.target) && !button.contains(e.target)) {
        return self.isSelectProject(false);
      }
    });
    return null;
  };
  renderFrame = function() {
    if (self.newTime() === null) {
      return;
    }
    self.newTime().endTs = new Date().getTime();
    self.diff(self.newTime().endTs - self.newTime().startTs);
    self.loopCounter += 1;
    if (self.loopCounter % 30 === 0) {
      newTimeSave();
    }
    return window.requestAnimationFrame(renderFrame);
  };
  newTimeSave = function() {
    var idx, times;
    times = self.currentTimes();
    idx = _.findIndex(times, function(time) {
      return time.startTs === self.newTime().startTs;
    });
    if (idx < 0) {
      times.unshift(self.newTime());
    } else {
      times[idx] = self.newTime();
    }
    save();
    return load();
  };
  self.formatMilliseconds = formatMilliseconds;
  self.selectProjectClick = function(e) {
    e.stopPropagation;
    return null;
  };
  self.selectProjectChange = save;
  self.toggleSelectProject = function() {
    if (self.isToggleProject()) {
      self.isSelectProject(!self.isSelectProject());
    }
    return null;
  };
  self.addProject = function() {
    var data, title;
    if (self.newTime() !== null) {
      return window.alert('Нельзя добавить проект пока работает таймер');
    }
    title = window.prompt('Введите название нового проекта:', '');
    if (title) {
      title = title.trim();
    }
    if (title === null) {
      return;
    }
    if (!title) {
      return window.alert('Вы не ввели название проекта');
    }
    if (self.titles().indexOf(title) !== -1) {
      return window.alert('Такой проект уже существует');
    }
    data = self.data();
    data[title] = [];
    self.data(data);
    self.current(title);
    save();
    return null;
  };
  self.removeProject = function() {
    var data;
    if (self.newTime() !== null) {
      return window.alert('Нельзя удалить проект пока работает таймер');
    }
    if (window.confirm('Вы действительно хотите БЕЗВОЗВРАТНО удалить проект?')) {
      if (self.current() === 'Default') {
        return window.alert('Нельзя удалить проект `Default`');
      }
      data = self.data();
      delete data[self.current()];
      self.data(data);
      self.current('Default');
      save();
    }
    return null;
  };
  self.toggleTimer = function() {
    var now;
    if (self.newTime() === null) {
      self.loopCounter = 0;
      now = new Date().getTime();
      self.newTime({
        startTs: now,
        endTs: now,
        desc: window.prompt('Можете ввести пояснение:', '').trim(),
        closed: false
      });
      newTimeSave();
      window.requestAnimationFrame(renderFrame);
    } else {
      newTimeSave();
      self.newTime(null);
      self.diff(0);
    }
    return null;
  };
  self.closeTime = function(time) {
    if (self.newTime() !== null) {
      return window.alert('Нельзя учесть пока работает таймер');
    }
    _.find(self.currentTimes(), function(item) {
      if (item.startTs === time.startTs()) {
        item.closed = time.closed();
      }
    });
    save();
    return load();
  };
  self.removeTime = function(time) {
    if (self.newTime() !== null) {
      return window.alert('Нельзя удалить пока работает таймер');
    }
    if (!confirm('Действительно хотите удалить\nбез возможности восстановить?')) {
      return;
    }
    self.data()[self.current()] = _.reject(self.currentTimes(), function(item) {
      return item.startTs === time.startTs();
    });
    save();
    load();
    return null;
  };
  load();
  bindEvents();
  return self;
};

TIMETRACKER.TimeViewModel = function(params) {
  var app, self;
  self = this;
  app = params.app;
  self.startTs = ko.observable(params.item.startTs);
  self.endTs = ko.observable(params.item.endTs);
  self.desc = ko.observable(params.item.desc);
  self.closed = ko.observable(params.item.closed);
  self.diff = ko.computed(function() {
    return formatMilliseconds(self.endTs() - self.startTs());
  });
  self.start = ko.computed(function() {
    return new Date(self.startTs()).toLocaleString('ru-RU');
  });
  self.end = ko.computed(function() {
    return new Date(self.endTs()).toLocaleString('ru-RU');
  });
  self.closed.subscribe(function() {
    return app.closeTime(self);
  });
  self.remove = function() {
    return app.removeTime(self);
  };
  return self;
};

ko.components.register('time-row', {
  viewModel: TIMETRACKER.TimeViewModel,
  template: {
    element: 'time-row-tmpl'
  }
});

window.onload = function() {
  return ko.applyBindings(new TIMETRACKER.AppViewModel(), document.getElementById('content-wrapper'));
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibWFpbi5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBQTs7QUFBQSxXQUFBLEdBQWM7RUFDVixRQUFBLEVBQVc7SUFDUCxjQUFBLEVBQWlCLGtCQURWO0dBREQ7RUFJVixJQUFBLEVBQU87SUFDSCxPQUFBLEVBQVUsU0FEUDtJQUVILElBQUEsRUFBTztNQUNILFNBQUEsRUFBWSxFQURUO0tBRko7R0FKRzs7O0FBYWQsa0JBQUEsR0FBcUIsU0FBQyxFQUFEO0FBQ2pCLE1BQUE7RUFBQSxFQUFBLEdBQUssQ0FBQyxFQUFBLEdBQUssSUFBTixDQUFBLEdBQWM7RUFDbkIsT0FBQSxHQUFVLEVBQUEsR0FBSztFQUNmLE9BQUEsR0FBVSxDQUFDLENBQUMsRUFBQSxHQUFLLEVBQU4sQ0FBQSxHQUFZLEVBQWIsQ0FBQSxHQUFtQjtFQUM3QixLQUFBLEdBQVEsQ0FBQyxFQUFBLEdBQUssRUFBTCxHQUFVLEVBQVgsQ0FBQSxHQUFpQjtFQUN6QixJQUFHLE9BQUEsR0FBVSxFQUFiO0lBQ0ksT0FBQSxHQUFVLEdBQUEsR0FBSSxRQURsQjs7RUFFQSxJQUFHLE9BQUEsR0FBVSxFQUFiO0lBQ0ksT0FBQSxHQUFVLEdBQUEsR0FBSSxRQURsQjs7U0FFRyxLQUFELEdBQU8sR0FBUCxHQUFVLE9BQVYsR0FBa0IsR0FBbEIsR0FBcUI7QUFUTjs7QUFZckIsV0FBVyxDQUFDLFlBQVosR0FBMkIsU0FBQTtBQUN2QixNQUFBO0VBQUEsSUFBQSxHQUFPO0VBQ1AsSUFBSSxDQUFDLFdBQUwsR0FBbUI7RUFDbkIsSUFBSSxDQUFDLElBQUwsR0FBWSxFQUFFLENBQUMsVUFBSCxDQUFjLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBL0I7RUFDWixJQUFJLENBQUMsTUFBTCxHQUFjLEVBQUUsQ0FBQyxRQUFILENBQVksU0FBQTtXQUN0QixDQUFDLENBQUMsSUFBRixDQUFPLElBQUksQ0FBQyxJQUFMLENBQUEsQ0FBUDtFQURzQixDQUFaO0VB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QUFYO0dBRnFCO0NBQW5DOztBQU1BLE1BQU0sQ0FBQyxNQUFQLEdBQWdCLFNBQUE7U0FDWixFQUFFLENBQUMsYUFBSCxDQUFpQixJQUFJLFdBQVcsQ0FBQyxZQUFoQixDQUFBLENBQWpCLEVBQWlELFFBQVEsQ0FBQyxjQUFULENBQXdCLGlCQUF4QixDQUFqRDtBQURZIiwic291cmNlc0NvbnRlbnQiOlsiXG5USU1FVFJBQ0tFUiA9IHtcbiAgICBTZXR0aW5ncyA6IHtcbiAgICAgICAgZGF0YVN0b3JhZ2VLZXkgOiAndGltZXRyYWNrZXItZGF0YSdcbiAgICB9XG4gICAgRGF0YSA6IHtcbiAgICAgICAgY3VycmVudCA6ICdEZWZhdWx0J1xuICAgICAgICBkYXRhIDoge1xuICAgICAgICAgICAgJ0RlZmF1bHQnIDogW11cbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5mb3JtYXRNaWxsaXNlY29uZHMgPSAobXMpIC0+XG4gICAgbXMgPSAobXMgKiAuMDAxKSB8IDBcbiAgICBzZWNvbmRzID0gbXMgJSA2MFxuICAgIG1pbnV0ZXMgPSAoKG1zIC8gNjApICUgNjApIHwgMFxuICAgIGhvdXJzID0gKG1zIC8gNjAgLyA2MCkgfCAwXG4gICAgaWYgc2Vjb25kcyA8IDEwXG4gICAgICAgIHNlY29uZHMgPSBcIjAje3NlY29uZHN9XCJcbiAgICBpZiBtaW51dGVzIDwgMTBcbiAgICAgICAgbWludXRlcyA9IFwiMCN7bWludXRlc31cIlxuICAgIFwiI3tob3Vyc306I3ttaW51dGVzfToje3NlY29uZHN9XCJcblxuXG5USU1FVFJBQ0tFUi5BcHBWaWV3TW9kZWwgPSAtPlxuICAgIHNlbGYgPSBAXG4gICAgc2VsZi5sb29wQ291bnRlciA9IDBcbiAgICBzZWxmLmRhdGEgPSBrby5vYnNlcnZhYmxlIFRJTUVUUkFDS0VSLkRhdGEuZGF0YVxuICAgIHNlbGYudGl0bGVzID0ga28uY29tcHV0ZWQgLT5cbiAgICAgICAgXy5rZXlzIHNlbGYuZGF0YSgpXG4gICAgc2VsZi5jdXJyZW50ID0ga28ub2JzZXJ2YWJsZSBUSU1FVFJBQ0tFUi5EYXRhLmN1cnJlbnRcbiAgICBzZWxmLmlzU2VsZWN0UHJvamVjdCA9IGtvLm9ic2VydmFibGUgZmFsc2VcbiAgICBzZWxmLmlzVG9nZ2xlUHJvamVjdCA9IGtvLmNvbXB1dGVkIC0+XG4gICAgICAgIHNlbGYudGl0bGVzKCkubGVuZ3RoID4gMVxuICAgIHNlbGYuZGlmZiA9IGtvLm9ic2VydmFibGUgMFxuICAgIHNlbGYuY3VycmVudFRpbWVzID0ga28uY29tcHV0ZWQgLT5cbiAgICAgICAgc2VsZi5kYXRhKClbc2VsZi5jdXJyZW50KCldIG9yIFtdXG4gICAgc2VsZi5jdXJyZW50VGltZXNTaXplID0ga28uY29tcHV0ZWQgLT5cbiAgICAgICAgc2VsZi5jdXJyZW50VGltZXMoKS5sZW5ndGhcbiAgICBzZWxmLnRvdGFsVGltZSA9IGtvLmNvbXB1dGVkIC0+XG4gICAgICAgIF8ucmVkdWNlIHNlbGYuY3VycmVudFRpbWVzKCksIChtZW1vLCB0aW1lKSAtPlxuICAgICAgICAgICAgbWVtbyArICh0aW1lLmVuZFRzIC0gdGltZS5zdGFydFRzKVxuICAgICAgICAsIDBcbiAgICBzZWxmLmNsb3NlZFRpbWUgPSBrby5jb21wdXRlZCAtPlxuICAgICAgICBfLnJlZHVjZSBzZWxmLmN1cnJlbnRUaW1lcygpLCAobWVtbywgdGltZSkgLT5cbiAgICAgICAgICAgIGRpZmYgPSBpZiB0aW1lLmNsb3NlZCB0aGVuIDAgZWxzZSB0aW1lLmVuZFRzIC0gdGltZS5zdGFydFRzXG4gICAgICAgICAgICBtZW1vICsgZGlmZlxuICAgICAgICAsIDBcbiAgICBzZWxmLm5ld1RpbWUgPSBrby5vYnNlcnZhYmxlIG51bGxcblxuICAgIGxvYWQgPSAtPlxuICAgICAgICBkYXRhID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtIFRJTUVUUkFDS0VSLlNldHRpbmdzLmRhdGFTdG9yYWdlS2V5XG4gICAgICAgIGlmIGRhdGFcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlIGRhdGFcbiAgICAgICAgICAgIHNlbGYuZGF0YSBkYXRhLmRhdGFcbiAgICAgICAgICAgIHNlbGYuY3VycmVudCBkYXRhLmN1cnJlbnRcbiAgICAgICAgbnVsbFxuXG4gICAgc2F2ZSA9IC0+XG4gICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeSB7XG4gICAgICAgICAgICBjdXJyZW50IDogc2VsZi5jdXJyZW50KClcbiAgICAgICAgICAgIGRhdGEgOiBzZWxmLmRhdGEoKVxuICAgICAgICB9XG4gICAgICAgICNjb25zb2xlLmxvZyAnc2F2ZScsIGRhdGFcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtIFRJTUVUUkFDS0VSLlNldHRpbmdzLmRhdGFTdG9yYWdlS2V5LCBkYXRhXG4gICAgICAgIG51bGxcblxuICAgIGJpbmRFdmVudHMgPSAtPlxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdtb3VzZXVwJywgKGUpIC0+XG4gICAgICAgICAgICBzZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWxlY3Quc2VsZWN0LXByb2plY3QnKVxuICAgICAgICAgICAgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYS5zd2FwLXByb2plY3QnKVxuICAgICAgICAgICAgaWYgbm90IHNlbGVjdC5jb250YWlucyhlLnRhcmdldCkgYW5kIG5vdCBidXR0b24uY29udGFpbnMoZS50YXJnZXQpXG4gICAgICAgICAgICAgICAgc2VsZi5pc1NlbGVjdFByb2plY3QgZmFsc2VcbiAgICAgICAgbnVsbFxuXG4gICAgcmVuZGVyRnJhbWUgPSAtPlxuICAgICAgICBpZiBzZWxmLm5ld1RpbWUoKSBpcyBudWxsXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgc2VsZi5uZXdUaW1lKCkuZW5kVHMgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgICBzZWxmLmRpZmYoc2VsZi5uZXdUaW1lKCkuZW5kVHMgLSBzZWxmLm5ld1RpbWUoKS5zdGFydFRzKVxuICAgICAgICBzZWxmLmxvb3BDb3VudGVyICs9IDFcbiAgICAgICAgaWYgc2VsZi5sb29wQ291bnRlciAlIDMwIGlzIDAgIyBwZXIgMC41IHNlY29uZHNcbiAgICAgICAgICAgIG5ld1RpbWVTYXZlKClcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSByZW5kZXJGcmFtZVxuXG4gICAgbmV3VGltZVNhdmUgPSAtPlxuICAgICAgICB0aW1lcyA9IHNlbGYuY3VycmVudFRpbWVzKClcbiAgICAgICAgaWR4ID0gXy5maW5kSW5kZXggdGltZXMsICh0aW1lKSAtPiB0aW1lLnN0YXJ0VHMgPT0gc2VsZi5uZXdUaW1lKCkuc3RhcnRUc1xuICAgICAgICBpZiBpZHggPCAwXG4gICAgICAgICAgICB0aW1lcy51bnNoaWZ0IHNlbGYubmV3VGltZSgpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRpbWVzW2lkeF0gPSBzZWxmLm5ld1RpbWUoKVxuICAgICAgICBzYXZlKClcbiAgICAgICAgbG9hZCgpXG5cbiAgICBzZWxmLmZvcm1hdE1pbGxpc2Vjb25kcyA9IGZvcm1hdE1pbGxpc2Vjb25kc1xuXG4gICAgc2VsZi5zZWxlY3RQcm9qZWN0Q2xpY2sgPSAoZSkgLT5cbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb25cbiAgICAgICAgbnVsbFxuXG4gICAgc2VsZi5zZWxlY3RQcm9qZWN0Q2hhbmdlID0gc2F2ZVxuXG4gICAgc2VsZi50b2dnbGVTZWxlY3RQcm9qZWN0ID0gLT5cbiAgICAgICAgaWYgc2VsZi5pc1RvZ2dsZVByb2plY3QoKVxuICAgICAgICAgICAgc2VsZi5pc1NlbGVjdFByb2plY3QgIXNlbGYuaXNTZWxlY3RQcm9qZWN0KClcbiAgICAgICAgbnVsbFxuXG4gICAgc2VsZi5hZGRQcm9qZWN0ID0gLT5cbiAgICAgICAgaWYgc2VsZi5uZXdUaW1lKCkgaXNudCBudWxsXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFsZXJ0ICfQndC10LvRjNC30Y8g0LTQvtCx0LDQstC40YLRjCDQv9GA0L7QtdC60YIg0L/QvtC60LAg0YDQsNCx0L7RgtCw0LXRgiDRgtCw0LnQvNC10YAnXG4gICAgICAgIHRpdGxlID0gd2luZG93LnByb21wdCgn0JLQstC10LTQuNGC0LUg0L3QsNC30LLQsNC90LjQtSDQvdC+0LLQvtCz0L4g0L/RgNC+0LXQutGC0LA6JywgJycpXG4gICAgICAgIGlmIHRpdGxlXG4gICAgICAgICAgICB0aXRsZSA9IHRpdGxlLnRyaW0oKVxuICAgICAgICBpZiB0aXRsZSBpcyBudWxsXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgaWYgbm90IHRpdGxlXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFsZXJ0ICfQktGLINC90LUg0LLQstC10LvQuCDQvdCw0LfQstCw0L3QuNC1INC/0YDQvtC10LrRgtCwJ1xuICAgICAgICBpZiBzZWxmLnRpdGxlcygpLmluZGV4T2YodGl0bGUpICE9IC0xXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFsZXJ0ICfQotCw0LrQvtC5INC/0YDQvtC10LrRgiDRg9C20LUg0YHRg9GJ0LXRgdGC0LLRg9C10YInXG4gICAgICAgIGRhdGEgPSBzZWxmLmRhdGEoKVxuICAgICAgICBkYXRhW3RpdGxlXSA9IFtdXG4gICAgICAgIHNlbGYuZGF0YSBkYXRhXG4gICAgICAgIHNlbGYuY3VycmVudCB0aXRsZVxuICAgICAgICBzYXZlKClcbiAgICAgICAgbnVsbFxuXG4gICAgc2VsZi5yZW1vdmVQcm9qZWN0ID0gLT5cbiAgICAgICAgaWYgc2VsZi5uZXdUaW1lKCkgaXNudCBudWxsXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmFsZXJ0ICfQndC10LvRjNC30Y8g0YPQtNCw0LvQuNGC0Ywg0L/RgNC+0LXQutGCINC/0L7QutCwINGA0LDQsdC+0YLQsNC10YIg0YLQsNC50LzQtdGAJ1xuICAgICAgICBpZiB3aW5kb3cuY29uZmlybSAn0JLRiyDQtNC10LnRgdGC0LLQuNGC0LXQu9GM0L3QviDRhdC+0YLQuNGC0LUg0JHQldCX0JLQntCX0JLQoNCQ0KLQndCeINGD0LTQsNC70LjRgtGMINC/0YDQvtC10LrRgj8nXG4gICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnQoKSA9PSAnRGVmYXVsdCdcbiAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93LmFsZXJ0ICfQndC10LvRjNC30Y8g0YPQtNCw0LvQuNGC0Ywg0L/RgNC+0LXQutGCIGBEZWZhdWx0YCdcbiAgICAgICAgICAgIGRhdGEgPSBzZWxmLmRhdGEoKVxuICAgICAgICAgICAgZGVsZXRlIGRhdGFbc2VsZi5jdXJyZW50KCldXG4gICAgICAgICAgICBzZWxmLmRhdGEgZGF0YVxuICAgICAgICAgICAgc2VsZi5jdXJyZW50ICdEZWZhdWx0J1xuICAgICAgICAgICAgc2F2ZSgpXG4gICAgICAgIG51bGxcblxuICAgIHNlbGYudG9nZ2xlVGltZXIgPSAtPlxuICAgICAgICBpZiBzZWxmLm5ld1RpbWUoKSBpcyBudWxsXG4gICAgICAgICAgICBzZWxmLmxvb3BDb3VudGVyID0gMFxuICAgICAgICAgICAgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgICAgICAgIHNlbGYubmV3VGltZSB7XG4gICAgICAgICAgICAgICAgc3RhcnRUcyA6IG5vdyxcbiAgICAgICAgICAgICAgICBlbmRUcyA6IG5vdyxcbiAgICAgICAgICAgICAgICBkZXNjIDogd2luZG93LnByb21wdCgn0JzQvtC20LXRgtC1INCy0LLQtdGB0YLQuCDQv9C+0Y/RgdC90LXQvdC40LU6JywgJycpLnRyaW0oKSxcbiAgICAgICAgICAgICAgICBjbG9zZWQgOiBmYWxzZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG5ld1RpbWVTYXZlKClcbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgcmVuZGVyRnJhbWVcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgbmV3VGltZVNhdmUoKVxuICAgICAgICAgICAgc2VsZi5uZXdUaW1lIG51bGxcbiAgICAgICAgICAgIHNlbGYuZGlmZiAwXG4gICAgICAgIG51bGxcblxuICAgIHNlbGYuY2xvc2VUaW1lID0gKHRpbWUpIC0+XG4gICAgICAgIGlmIHNlbGYubmV3VGltZSgpIGlzbnQgbnVsbFxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5hbGVydCAn0J3QtdC70YzQt9GPINGD0YfQtdGB0YLRjCDQv9C+0LrQsCDRgNCw0LHQvtGC0LDQtdGCINGC0LDQudC80LXRgCdcbiAgICAgICAgXy5maW5kIHNlbGYuY3VycmVudFRpbWVzKCksIChpdGVtKSAtPlxuICAgICAgICAgICAgaWYgaXRlbS5zdGFydFRzID09IHRpbWUuc3RhcnRUcygpXG4gICAgICAgICAgICAgICAgaXRlbS5jbG9zZWQgPSB0aW1lLmNsb3NlZCgpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIHNhdmUoKVxuICAgICAgICBsb2FkKClcblxuICAgIHNlbGYucmVtb3ZlVGltZSA9ICh0aW1lKSAtPlxuICAgICAgICBpZiBzZWxmLm5ld1RpbWUoKSBpc250IG51bGxcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuYWxlcnQgJ9Cd0LXQu9GM0LfRjyDRg9C00LDQu9C40YLRjCDQv9C+0LrQsCDRgNCw0LHQvtGC0LDQtdGCINGC0LDQudC80LXRgCdcbiAgICAgICAgaWYgbm90IGNvbmZpcm0gJ9CU0LXQudGB0YLQstC40YLQtdC70YzQvdC+INGF0L7RgtC40YLQtSDRg9C00LDQu9C40YLRjFxcbtCx0LXQtyDQstC+0LfQvNC+0LbQvdC+0YHRgtC4INCy0L7RgdGB0YLQsNC90L7QstC40YLRjD8nXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgc2VsZi5kYXRhKClbc2VsZi5jdXJyZW50KCldID0gXy5yZWplY3Qgc2VsZi5jdXJyZW50VGltZXMoKSwgKGl0ZW0pIC0+XG4gICAgICAgICAgICBpdGVtLnN0YXJ0VHMgPT0gdGltZS5zdGFydFRzKClcbiAgICAgICAgc2F2ZSgpXG4gICAgICAgIGxvYWQoKVxuICAgICAgICBudWxsXG5cbiAgICBsb2FkKClcbiAgICBiaW5kRXZlbnRzKClcblxuICAgIHNlbGZcblxuXG5USU1FVFJBQ0tFUi5UaW1lVmlld01vZGVsID0gKHBhcmFtcykgLT5cbiAgICBzZWxmID0gQFxuICAgIGFwcCA9IHBhcmFtcy5hcHBcbiAgICBzZWxmLnN0YXJ0VHMgPSBrby5vYnNlcnZhYmxlIHBhcmFtcy5pdGVtLnN0YXJ0VHNcbiAgICBzZWxmLmVuZFRzID0ga28ub2JzZXJ2YWJsZSBwYXJhbXMuaXRlbS5lbmRUc1xuICAgIHNlbGYuZGVzYyA9IGtvLm9ic2VydmFibGUgcGFyYW1zLml0ZW0uZGVzY1xuICAgIHNlbGYuY2xvc2VkID0ga28ub2JzZXJ2YWJsZSBwYXJhbXMuaXRlbS5jbG9zZWRcbiAgICBzZWxmLmRpZmYgPSBrby5jb21wdXRlZCAtPlxuICAgICAgICBmb3JtYXRNaWxsaXNlY29uZHMgc2VsZi5lbmRUcygpIC0gc2VsZi5zdGFydFRzKClcbiAgICBzZWxmLnN0YXJ0ID0ga28uY29tcHV0ZWQgLT5cbiAgICAgICAgbmV3IERhdGUoc2VsZi5zdGFydFRzKCkpLnRvTG9jYWxlU3RyaW5nKCdydS1SVScpXG4gICAgc2VsZi5lbmQgPSBrby5jb21wdXRlZCAtPlxuICAgICAgICBuZXcgRGF0ZShzZWxmLmVuZFRzKCkpLnRvTG9jYWxlU3RyaW5nKCdydS1SVScpXG5cbiAgICBzZWxmLmNsb3NlZC5zdWJzY3JpYmUgLT5cbiAgICAgICAgYXBwLmNsb3NlVGltZSBzZWxmXG5cbiAgICBzZWxmLnJlbW92ZSA9IC0+XG4gICAgICAgIGFwcC5yZW1vdmVUaW1lIHNlbGZcblxuICAgIHNlbGZcblxuXG5rby5jb21wb25lbnRzLnJlZ2lzdGVyICd0aW1lLXJvdycsIHtcbiAgICB2aWV3TW9kZWw6IFRJTUVUUkFDS0VSLlRpbWVWaWV3TW9kZWxcbiAgICB0ZW1wbGF0ZTogeyBlbGVtZW50OiAndGltZS1yb3ctdG1wbCcgfVxufVxuXG5cbndpbmRvdy5vbmxvYWQgPSAtPlxuICAgIGtvLmFwcGx5QmluZGluZ3MobmV3IFRJTUVUUkFDS0VSLkFwcFZpZXdNb2RlbCgpLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudC13cmFwcGVyJykpXG4iXX0=
