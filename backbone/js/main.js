var TIMETRACKER;

TIMETRACKER = {
  Settings: {
    dataStorageKey: 'timetracker-data'
  },
  DefaultData: function() {
    return {
      current: 'Default',
      data: {
        'Default': []
      }
    };
  },
  Data: {},
  formatMilliseconds: function(ms) {
    var hours, minutes, seconds;
    ms = (ms * .001) | 0;
    seconds = ms % 60;
    minutes = ((ms / 60) % 60) | 0;
    hours = (ms / 60 / 60) | 0;
    if (seconds < 10) {
      seconds = "0" + seconds;
    }
    if (minutes < 10) {
      minutes = "0" + minutes;
    }
    return hours + ":" + minutes + ":" + seconds;
  },
  toggleProjectSelectList: function() {
    $('.swap-project').toggle();
    $('.select-project').toggle();
    return null;
  }
};

Backbone.sync = function(method, model, options) {
  var data, resp;
  if (options == null) {
    options = {};
  }
  switch (method) {
    case 'read':
      data = localStorage.getItem(TIMETRACKER.Settings.dataStorageKey);
      if (data) {
        data = JSON.parse(data);
      }
      data = data || TIMETRACKER.DefaultData();
      resp = _.map(data.data, function(times, project) {
        return {
          name: project,
          current: project === data.current,
          times: new TIMETRACKER.TimesCollection(times)
        };
      });
      break;
    case 'create':
    case 'update':
    case 'delete':
      data = TIMETRACKER.DefaultData();
      TIMETRACKER.Data.each(function(project) {
        if (project.get('current')) {
          data.current = project.get('name');
        }
        return data.data[project.get('name')] = project.get('times').toJSON();
      });
      localStorage.setItem(TIMETRACKER.Settings.dataStorageKey, JSON.stringify(data));
      if (model instanceof TIMETRACKER.ProjectsCollection) {
        resp = TIMETRACKER.Data.map(function(project) {
          return project.toJSON();
        });
      }
  }
  if (resp && options.success) {
    return options.success.call(model, resp, options);
  }
};

TIMETRACKER.TimeModel = Backbone.Model.extend({
  defaults: {
    closed: false
  },
  start: function() {
    return new Date(this.get('startTs')).toLocaleString('ru-RU');
  },
  end: function() {
    return new Date(this.get('endTs')).toLocaleString('ru-RU');
  },
  diff: function() {
    return this.get('endTs') - this.get('startTs');
  },
  diffMs: function() {
    return TIMETRACKER.formatMilliseconds(this.diff());
  },
  closedCls: function() {
    if (this.get('closed')) {
      return 'closed';
    } else {
      return '';
    }
  },
  hiddenCls: function() {
    return [this.closedCls(), 'm-hidden'].join(' ');
  },
  asDict: function() {
    return {
      checked: this.get('closed') ? 'checked' : '',
      desc: this.get('desc'),
      start: this.start(),
      end: this.end(),
      diff: this.diff(),
      diffMs: this.diffMs(),
      closedCls: this.closedCls(),
      hiddenCls: this.hiddenCls()
    };
  }
});

TIMETRACKER.TimesCollection = Backbone.Collection.extend({
  model: TIMETRACKER.TimeModel
});

TIMETRACKER.TimeView = Backbone.View.extend({
  tagName: 'tr',
  template: _.template($('#time-row-tmpl').html()),
  events: {
    'click .clear-btn': 'removeTime',
    'click .closer': 'closeTime'
  },
  initialize: function() {
    _.bindAll(this, 'render', 'removeTime', 'closeTime', 'remove');
    this.model.bind('change', this.render);
    return this.model.bind('destroy', this.remove);
  },
  removeTime: function(e) {
    e.preventDefault();
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя удалить время пока работает таймер');
    }
    this.model.destroy();
    this.trigger('destroy:time');
    return null;
  },
  closeTime: function(e) {
    e.preventDefault();
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя переключить время пока работает таймер');
    }
    this.model.set('closed', !this.model.get('closed')).save();
    this.trigger('update:time');
    return null;
  },
  render: function() {
    this.$el.html(this.template(this.model.asDict()));
    return this;
  },
  remove: function() {
    this.off();
    return this.$el.remove();
  }
});

TIMETRACKER.TimesView = Backbone.View.extend({
  el: $('.times'),
  initialize: function() {
    _.bindAll(this, 'render', 'currentTimes', 'addOneTime');
    this.currentTimes();
    return this.collection.bind('remove', function() {
      return Backbone.sync('update', this.collection);
    });
  },
  render: function() {
    this.currentTimes();
    if (this.collection.length) {
      this.$el.find('.results').show().find('tbody').empty();
      this.$el.find('.empty').hide();
      this.collection.each(this.addOneTime);
    } else {
      this.$el.find('.results').hide();
      this.$el.find('.empty').show();
    }
    return this;
  },
  addOneTime: function(time) {
    var timesView, view;
    timesView = this;
    view = new TIMETRACKER.TimeView({
      model: time
    });
    view.on('destroy:time update:time', function() {
      return timesView.trigger('update:times');
    });
    this.$el.find('.results tbody').append(view.render().$el);
    return null;
  },
  currentTimes: function() {
    return this.collection = TIMETRACKER.Data.findWhere({
      current: true
    }).get('times');
  }
});

TIMETRACKER.ProjectModel = Backbone.Model.extend({
  defaults: {
    current: false,
    times: []
  },
  asDict: function() {
    return {
      selected: this.get('current') ? 'selected' : '',
      name: this.get('name')
    };
  }
});

TIMETRACKER.ProjectsCollection = Backbone.Collection.extend({
  model: TIMETRACKER.ProjectModel
});

TIMETRACKER.ProjectView = Backbone.View.extend({
  tagName: 'option',
  initialize: function() {
    return _.bindAll(this, 'render');
  },
  render: function() {
    var name;
    name = this.model.get('name');
    this.$el.text(name).val(name).attr('selected', this.model.get('current'));
    return this;
  }
});

TIMETRACKER.ProjectsView = Backbone.View.extend({
  el: $('select.select-project'),
  events: {
    'change': 'selectProject',
    'click': 'clickSelectProject'
  },
  initialize: function() {
    _.bindAll(this, 'render', 'addOneProject', 'selectProject', 'clickSelectProject');
    return this.collection = TIMETRACKER.Data;
  },
  render: function() {
    this.$el.empty();
    if (this.collection.length) {
      this.collection.each(this.addOneProject);
    }
    return this;
  },
  addOneProject: function(project) {
    var view;
    view = new TIMETRACKER.ProjectView({
      model: project
    });
    this.$el.append(view.render().$el);
    return null;
  },
  selectProject: function(e) {
    var collection, value;
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя выбрать проект пока работает таймер');
    }
    value = this.$el.val();
    collection = this.collection;
    collection.forEach(function(model) {
      return model.set('current', value === model.get('name'));
    });
    collection.trigger('toggle');
    TIMETRACKER.toggleProjectSelectList();
    return null;
  },
  clickSelectProject: function(e) {
    e.stopPropagation();
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя, пока работает таймер');
    }
    return null;
  }
});

TIMETRACKER.TitleView = Backbone.View.extend({
  el: $('.title-container'),
  events: {
    'click   .swap-project': 'swapProject',
    'click    .add-project': 'addProject',
    'click .remove-project': 'removeProject'
  },
  initialize: function() {
    _.bindAll(this, 'render', 'swapProject', 'addProject', 'removeProject', 'closeSelectProject');
    $(window).on('click', this.closeSelectProject);
    this.collection = TIMETRACKER.Data;
    return this.projectsView = new TIMETRACKER.ProjectsView();
  },
  render: function() {
    var current;
    current = TIMETRACKER.Data.findWhere({
      current: true
    });
    this.$el.find('.project-name').text(" — " + (current.get('name')));
    this.projectsView.render();
    return this;
  },
  swapProject: function(e) {
    e.preventDefault();
    e.stopPropagation();
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя переключить проект пока работает таймер');
    }
    TIMETRACKER.toggleProjectSelectList();
    return null;
  },
  addProject: function(e) {
    var title;
    e.preventDefault();
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя добавить проект пока работает таймер');
    }
    title = prompt('Введите название нового проекта:');
    title = $.trim(title || '');
    if (!title) {
      return alert('Вы не ввели название проекта');
    }
    if (this.collection.pluck('name').indexOf(title) !== -1) {
      return alert('Такой проект уже существует');
    }
    this.collection.forEach(function(model) {
      return model.set('current', false);
    });
    this.collection.add({
      name: title,
      current: true,
      times: new TIMETRACKER.TimesCollection
    });
    this.collection.trigger('toggle');
    return null;
  },
  removeProject: function(e) {
    var current;
    e.preventDefault();
    if ($('#content-wrapper').hasClass('lock')) {
      return alert('Нельзя удалить проект пока работает таймер');
    }
    if (!confirm('Вы действительно хотите БЕЗВОЗВРАТНО удалить проект?')) {
      return;
    }
    current = this.collection.findWhere({
      current: true
    });
    if ('Default' === current.get('name')) {
      return alert('Нельзя удалить проект `Default`');
    }
    this.collection.remove(current);
    this.collection.forEach(function(model) {
      return model.set('current', 'Default' === model.get('name'));
    });
    this.collection.trigger('toggle');
    return null;
  },
  closeSelectProject: function(e) {
    e.stopPropagation();
    if ($('.select-project').is(':visible') && !$(e.target).hasClass('select-project')) {
      TIMETRACKER.toggleProjectSelectList();
    }
    return null;
  }
});

TIMETRACKER.TimerView = Backbone.View.extend({
  el: $('.timer-container'),
  events: {
    'click a.label': 'toggleTimer',
    'click a.btn': 'toggleTimer'
  },
  initialize: function() {
    this.calcTotal();
    this.model = null;
    this.timerEl = this.$el.find('a.label');
    this.btnEl = this.$el.find('i.fa');
    this.totalEl = this.$el.find('.total-time .total.value').text(TIMETRACKER.formatMilliseconds(this.total));
    this.openedEl = this.$el.find('.total-time .opened.value').text(TIMETRACKER.formatMilliseconds(this.opened));
    return _.bindAll(this, 'render', 'toggleTimer', 'syncCollection', 'calcTotal');
  },
  render: function() {
    var diff, endTs, format;
    this.loopCounter += 1;
    format = TIMETRACKER.formatMilliseconds;
    if (this.model) {
      endTs = new Date().getTime();
      diff = endTs - this.model.get('startTs');
      this.timerEl.text(format(diff));
      this.totalEl.text(format(diff + this.total));
      this.openedEl.text(format(diff + this.opened));
      this.model.set('endTs', endTs);
      requestAnimationFrame(this.render);
    } else {
      this.calcTotal();
      this.totalEl.text(format(this.total));
      this.openedEl.text(format(this.opened));
    }
    return this;
  },
  toggleTimer: function(e) {
    var ts;
    e.preventDefault();
    $('#content-wrapper').toggleClass('lock');
    if (this.model) {
      this.btnEl.removeClass('fa-pause').addClass('fa-play');
      this.model.unbind('change', this.syncCollection);
      this.model = null;
    } else {
      this.btnEl.removeClass('fa-play').addClass('fa-pause');
      this.loopCounter = 0;
      ts = new Date().getTime();
      this.model = new TIMETRACKER.TimeModel({
        startTs: ts,
        endTs: ts,
        desc: (prompt('Можете ввести пояснение:') || '').trim()
      });
      this.model.bind('change', this.syncCollection);
      this.collection = TIMETRACKER.Data.findWhere({
        current: true
      });
      this.collection.get('times').unshift(this.model);
      requestAnimationFrame(this.render);
    }
    this.trigger('update:periodic');
    return null;
  },
  syncCollection: function() {
    if (this.model) {
      return Backbone.sync('update', TIMETRACKER.Data);
    }
  },
  calcTotal: function() {
    this.collection = TIMETRACKER.Data.findWhere({
      current: true
    });
    this.total = this.collection.get('times').reduce(function(prev, model) {
      return prev + model.diff();
    }, 0);
    return this.opened = this.collection.get('times').reduce(function(prev, model) {
      return prev + (model.get('closed') ? 0 : model.diff());
    }, 0);
  }
});

TIMETRACKER.AppView = Backbone.View.extend({
  id: 'content-wrapper',
  initialize: function() {
    _.bindAll(this, 'render');
    TIMETRACKER.Data = new TIMETRACKER.ProjectsCollection();
    TIMETRACKER.Data.fetch();
    TIMETRACKER.Data.on('toggle', function() {
      return Backbone.sync('update', TIMETRACKER.Data, {
        success: this.render
      });
    }, this);
    this.titleView = new TIMETRACKER.TitleView();
    this.timerView = new TIMETRACKER.TimerView();
    this.timesView = new TIMETRACKER.TimesView();
    this.timesView.on('update:times', this.timerView.render);
    this.timerView.on('update:periodic', this.timesView.render);
    return this.render();
  },
  render: function() {
    this.titleView.render();
    this.timerView.render();
    this.timesView.render();
    return this;
  }
});

window.onload = function() {
  return new TIMETRACKER.AppView();
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibWFpbi5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBQTs7QUFBQSxXQUFBLEdBQWM7RUFFVixRQUFBLEVBQVc7SUFDUCxjQUFBLEVBQWlCLGtCQURWO0dBRkQ7RUFNVixXQUFBLEVBQWMsU0FBQTtXQUNWO01BQ0ksT0FBQSxFQUFVLFNBRGQ7TUFFSSxJQUFBLEVBQU87UUFDSCxTQUFBLEVBQVksRUFEVDtPQUZYOztFQURVLENBTko7RUFjVixJQUFBLEVBQU8sRUFkRztFQWdCVixrQkFBQSxFQUFxQixTQUFDLEVBQUQ7QUFDakIsUUFBQTtJQUFBLEVBQUEsR0FBSyxDQUFDLEVBQUEsR0FBSyxJQUFOLENBQUEsR0FBYztJQUNuQixPQUFBLEdBQVUsRUFBQSxHQUFLO0lBQ2YsT0FBQSxHQUFVLENBQUMsQ0FBQyxFQUFBLEdBQUssRUFBTixDQUFBLEdBQVksRUFBYixDQUFBLEdBQW1CO0lBQzdCLEtBQUEsR0FBUSxDQUFDLEVBQUEsR0FBSyxFQUFMLEdBQVUsRUFBWCxDQUFBLEdBQWlCO0lBQ3pCLElBQUcsT0FBQSxHQUFVLEVBQWI7TUFDSSxPQUFBLEdBQVUsR0FBQSxHQUFJLFFBRGxCOztJQUVBLElBQUcsT0FBQSxHQUFVLEVBQWI7TUFDSSxPQUFBLEdBQVUsR0FBQSxHQUFJLFFBRGxCOztXQUVHLEtBQUQsR0FBTyxHQUFQLEdBQVUsT0FBVixHQUFrQixHQUFsQixHQUFxQjtFQVROLENBaEJYO0VBMkJWLHVCQUFBLEVBQTBCLFNBQUE7SUFDdEIsQ0FBQSxDQUFFLGVBQUYsQ0FBa0IsQ0FBQyxNQUFuQixDQUFBO0lBQ0EsQ0FBQSxDQUFFLGlCQUFGLENBQW9CLENBQUMsTUFBckIsQ0FBQTtXQUNBO0VBSHNCLENBM0JoQjs7O0FBbUNkLFFBQVEsQ0FBQyxJQUFULEdBQWdCLFNBQUMsTUFBRCxFQUFTLEtBQVQsRUFBZ0IsT0FBaEI7QUFFWixNQUFBOztJQUY0QixVQUFROztBQUVwQyxVQUFPLE1BQVA7QUFB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QixRQUFRLENBQUMsSUFBVCxDQUFjLFFBQWQsRUFBd0IsV0FBVyxDQUFDLElBQXBDLEVBQTBDO1FBQ3RDLE9BQUEsRUFBVSxJQUFDLENBQUEsTUFEMkI7T0FBMUM7SUFEMEIsQ0FBOUIsRUFJRSxJQUpGO0lBS0EsSUFBQyxDQUFBLFNBQUQsR0FBYSxJQUFJLFdBQVcsQ0FBQyxTQUFoQixDQUFBO0lBQ2IsSUFBQyxDQUFBLFNBQUQsR0FBYSxJQUFJLFdBQVcsQ0FBQyxTQUFoQixDQUFBO0lBQ2IsSUFBQyxDQUFBLFNBQUQsR0FBYSxJQUFJLFdBQVcsQ0FBQyxTQUFoQixDQUFBO0lBQ2IsSUFBQyxDQUFBLFNBQVMsQ0FBQyxFQUFYLENBQWMsY0FBZCxFQUE4QixJQUFDLENBQUEsU0FBUyxDQUFDLE1BQXpDO0lBQ0EsSUFBQyxDQUFBLFNBQVMsQ0FBQyxFQUFYLENBQWMsaUJBQWQsRUFBaUMsSUFBQyxDQUFBLFNBQVMsQ0FBQyxNQUE1QztXQUNBLElBQUMsQ0FBQSxNQUFELENBQUE7RUFkUyxDQUowQjtFQW9CdkMsTUFBQSxFQUFTLFNBQUE7SUFDTCxJQUFDLENBQUEsU0FBUyxDQUFDLE1BQVgsQ0FBQTtJQUNBLElBQUMsQ0FBQSxTQUFTLENBQUMsTUFBWCxDQUFBO0lBQ0EsSUFBQyxDQUFBLFNBQVMsQ0FBQyxNQUFYLENBQUE7V0FDQTtFQUpLLENBcEI4QjtDQUFyQjs7QUE2QnRCLE1BQU0sQ0FBQyxNQUFQLEdBQWdCLFNBQUE7U0FDWixJQUFJLFdBQVcsQ0FBQyxPQUFoQixDQUFBO0FBRFkiLCJzb3VyY2VzQ29udGVudCI6WyJcblRJTUVUUkFDS0VSID0ge1xuXG4gICAgU2V0dGluZ3MgOiB7XG4gICAgICAgIGRhdGFTdG9yYWdlS2V5IDogJ3RpbWV0cmFja2VyLWRhdGEnXG4gICAgfVxuXG4gICAgRGVmYXVsdERhdGEgOiAtPlxuICAgICAgICB7XG4gICAgICAgICAgICBjdXJyZW50IDogJ0RlZmF1bHQnXG4gICAgICAgICAgICBkYXRhIDoge1xuICAgICAgICAgICAgICAgICdEZWZhdWx0JyA6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIERhdGEgOiB7fVxuXG4gICAgZm9ybWF0TWlsbGlzZWNvbmRzIDogKG1zKSAtPlxuICAgICAgICBtcyA9IChtcyAqIC4wMDEpIHwgMFxuICAgICAgICBzZWNvbmRzID0gbXMgJSA2MFxuICAgICAgICBtaW51dGVzID0gKChtcyAvIDYwKSAlIDYwKSB8IDBcbiAgICAgICAgaG91cnMgPSAobXMgLyA2MCAvIDYwKSB8IDBcbiAgICAgICAgaWYgc2Vjb25kcyA8IDEwXG4gICAgICAgICAgICBzZWNvbmRzID0gXCIwI3tzZWNvbmRzfVwiXG4gICAgICAgIGlmIG1pbnV0ZXMgPCAxMFxuICAgICAgICAgICAgbWludXRlcyA9IFwiMCN7bWludXRlc31cIlxuICAgICAgICBcIiN7aG91cnN9OiN7bWludXRlc306I3tzZWNvbmRzfVwiXG5cbiAgICB0b2dnbGVQcm9qZWN0U2VsZWN0TGlzdCA6IC0+XG4gICAgICAgICQoJy5zd2FwLXByb2plY3QnKS50b2dnbGUoKVxuICAgICAgICAkKCcuc2VsZWN0LXByb2plY3QnKS50b2dnbGUoKVxuICAgICAgICBudWxsXG5cbn1cblxuXG5CYWNrYm9uZS5zeW5jID0gKG1ldGhvZCwgbW9kZWwsIG9wdGlvbnM9e30pIC0+XG4gICAgI2NvbnNvbGUubG9nIG1ldGhvZCwgbW9kZWwsIG9wdGlvbnNcbiAgICBzd2l0Y2ggbWV0aG9kXG4gICAgICAgIHdoZW4gJ3JlYWQnXG4gICAgICAgICAgICBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0gVElNRVRSQUNLRVIuU2V0dGluZ3MuZGF0YVN0b3JhZ2VLZXlcbiAgICAgICAgICAgIGlmIGRhdGFcbiAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZSBkYXRhXG4gICAgICAgICAgICAgICAgI2NvbnNvbGUubG9nIGRhdGFcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhIG9yIFRJTUVUUkFDS0VSLkRlZmF1bHREYXRhKClcbiAgICAgICAgICAgIHJlc3AgPSBfLm1hcCBkYXRhLmRhdGEsICh0aW1lcywgcHJvamVjdCkgLT5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUgOiBwcm9qZWN0XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgOiBwcm9qZWN0ID09IGRhdGEuY3VycmVudFxuICAgICAgICAgICAgICAgICAgICB0aW1lcyA6IG5ldyBUSU1FVFJBQ0tFUi5UaW1lc0NvbGxlY3Rpb24odGltZXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB3aGVuICdjcmVhdGUnLCAndXBkYXRlJywgJ2RlbGV0ZSdcbiAgICAgICAgICAgIGRhdGEgPSBUSU1FVFJBQ0tFUi5EZWZhdWx0RGF0YSgpXG4gICAgICAgICAgICBUSU1FVFJBQ0tFUi5EYXRhLmVhY2ggKHByb2plY3QpIC0+XG4gICAgICAgICAgICAgICAgaWYgcHJvamVjdC5nZXQoJ2N1cnJlbnQnKVxuICAgICAgICAgICAgICAgICAgICBkYXRhLmN1cnJlbnQgPSBwcm9qZWN0LmdldCgnbmFtZScpXG4gICAgICAgICAgICAgICAgZGF0YS5kYXRhW3Byb2plY3QuZ2V0KCduYW1lJyldID0gcHJvamVjdC5nZXQoJ3RpbWVzJykudG9KU09OKClcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtIFRJTUVUUkFDS0VSLlNldHRpbmdzLmRhdGFTdG9yYWdlS2V5LCBKU09OLnN0cmluZ2lmeSBkYXRhXG4gICAgICAgICAgICBpZiBtb2RlbCBpbnN0YW5jZW9mIFRJTUVUUkFDS0VSLlByb2plY3RzQ29sbGVjdGlvblxuICAgICAgICAgICAgICAgIHJlc3AgPSBUSU1FVFJBQ0tFUi5EYXRhLm1hcCAocHJvamVjdCkgLT5cbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdC50b0pTT04oKVxuICAgICNjb25zb2xlLmxvZyByZXNwLCBvcHRpb25zXG4gICAgaWYgcmVzcCBhbmQgb3B0aW9ucy5zdWNjZXNzXG4gICAgICAgIG9wdGlvbnMuc3VjY2Vzcy5jYWxsIG1vZGVsLCByZXNwLCBvcHRpb25zXG5cblxuVElNRVRSQUNLRVIuVGltZU1vZGVsID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kIHtcblxuICAgIGRlZmF1bHRzIDoge1xuICAgICAgICBjbG9zZWQgOiBmYWxzZVxuICAgIH1cblxuICAgIHN0YXJ0IDogLT5cbiAgICAgICAgbmV3IERhdGUoQGdldCAnc3RhcnRUcycpLnRvTG9jYWxlU3RyaW5nICdydS1SVSdcblxuICAgIGVuZCA6IC0+XG4gICAgICAgIG5ldyBEYXRlKEBnZXQgJ2VuZFRzJykudG9Mb2NhbGVTdHJpbmcgJ3J1LVJVJ1xuXG4gICAgZGlmZiA6IC0+XG4gICAgICAgIEBnZXQoJ2VuZFRzJykgLSBAZ2V0KCdzdGFydFRzJylcblxuICAgIGRpZmZNcyA6IC0+XG4gICAgICAgIFRJTUVUUkFDS0VSLmZvcm1hdE1pbGxpc2Vjb25kcyBAZGlmZigpXG5cbiAgICBjbG9zZWRDbHMgOiAtPlxuICAgICAgICBpZiBAZ2V0ICdjbG9zZWQnIHRoZW4gJ2Nsb3NlZCcgZWxzZSAnJ1xuXG4gICAgaGlkZGVuQ2xzIDogLT5cbiAgICAgICAgW0BjbG9zZWRDbHMoKSwgJ20taGlkZGVuJ10uam9pbiAnICdcblxuICAgIGFzRGljdCA6IC0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNoZWNrZWQgOiBpZiBAZ2V0ICdjbG9zZWQnIHRoZW4gJ2NoZWNrZWQnIGVsc2UgJydcbiAgICAgICAgICAgIGRlc2MgOiBAZ2V0ICdkZXNjJ1xuICAgICAgICAgICAgc3RhcnQgOiBAc3RhcnQoKVxuICAgICAgICAgICAgZW5kIDogQGVuZCgpXG4gICAgICAgICAgICBkaWZmIDogQGRpZmYoKVxuICAgICAgICAgICAgZGlmZk1zIDogQGRpZmZNcygpXG4gICAgICAgICAgICBjbG9zZWRDbHMgOiBAY2xvc2VkQ2xzKClcbiAgICAgICAgICAgIGhpZGRlbkNscyA6IEBoaWRkZW5DbHMoKVxuICAgICAgICB9XG59XG5cblxuVElNRVRSQUNLRVIuVGltZXNDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQge1xuICAgIG1vZGVsIDogVElNRVRSQUNLRVIuVGltZU1vZGVsXG59XG5cblxuVElNRVRSQUNLRVIuVGltZVZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCB7XG5cbiAgICB0YWdOYW1lIDogJ3RyJ1xuXG4gICAgdGVtcGxhdGUgOiBfLnRlbXBsYXRlICQoJyN0aW1lLXJvdy10bXBsJykuaHRtbCgpXG5cbiAgICBldmVudHMgOiB7XG4gICAgICAgICdjbGljayAuY2xlYXItYnRuJyA6ICdyZW1vdmVUaW1lJ1xuICAgICAgICAnY2xpY2sgLmNsb3NlcicgICAgOiAnY2xvc2VUaW1lJ1xuICAgIH1cblxuICAgIGluaXRpYWxpemUgOiAtPlxuICAgICAgICBfLmJpbmRBbGwgQCwgJ3JlbmRlcicsICdyZW1vdmVUaW1lJywgJ2Nsb3NlVGltZScsICdyZW1vdmUnXG4gICAgICAgIEBtb2RlbC5iaW5kICdjaGFuZ2UnLCBAcmVuZGVyXG4gICAgICAgIEBtb2RlbC5iaW5kICdkZXN0cm95JywgQHJlbW92ZVxuXG4gICAgcmVtb3ZlVGltZSA6IChlKSAtPlxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgaWYgJCgnI2NvbnRlbnQtd3JhcHBlcicpLmhhc0NsYXNzICdsb2NrJ1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQndC10LvRjNC30Y8g0YPQtNCw0LvQuNGC0Ywg0LLRgNC10LzRjyDQv9C+0LrQsCDRgNCw0LHQvtGC0LDQtdGCINGC0LDQudC80LXRgCdcbiAgICAgICAgQG1vZGVsLmRlc3Ryb3koKVxuICAgICAgICBAdHJpZ2dlciAnZGVzdHJveTp0aW1lJ1xuICAgICAgICBudWxsXG5cbiAgICBjbG9zZVRpbWUgOiAoZSkgLT5cbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGlmICQoJyNjb250ZW50LXdyYXBwZXInKS5oYXNDbGFzcyAnbG9jaydcbiAgICAgICAgICAgIHJldHVybiBhbGVydCAn0J3QtdC70YzQt9GPINC/0LXRgNC10LrQu9GO0YfQuNGC0Ywg0LLRgNC10LzRjyDQv9C+0LrQsCDRgNCw0LHQvtGC0LDQtdGCINGC0LDQudC80LXRgCdcbiAgICAgICAgQG1vZGVsLnNldCgnY2xvc2VkJywgIUBtb2RlbC5nZXQgJ2Nsb3NlZCcpLnNhdmUoKVxuICAgICAgICBAdHJpZ2dlciAndXBkYXRlOnRpbWUnXG4gICAgICAgIG51bGxcblxuICAgIHJlbmRlciA6IC0+XG4gICAgICAgIEAkZWwuaHRtbCBAdGVtcGxhdGUgQG1vZGVsLmFzRGljdCgpXG4gICAgICAgIEBcblxuICAgIHJlbW92ZSA6IC0+XG4gICAgICAgIEBvZmYoKVxuICAgICAgICBAJGVsLnJlbW92ZSgpXG59XG5cblxuVElNRVRSQUNLRVIuVGltZXNWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQge1xuXG4gICAgZWwgOiAkICcudGltZXMnXG5cbiAgICBpbml0aWFsaXplIDogLT5cbiAgICAgICAgXy5iaW5kQWxsIEAsICdyZW5kZXInLCAnY3VycmVudFRpbWVzJywgJ2FkZE9uZVRpbWUnXG4gICAgICAgIEBjdXJyZW50VGltZXMoKVxuICAgICAgICBAY29sbGVjdGlvbi5iaW5kICdyZW1vdmUnLCAtPlxuICAgICAgICAgICAgQmFja2JvbmUuc3luYyAndXBkYXRlJywgQGNvbGxlY3Rpb25cblxuICAgIHJlbmRlciA6IC0+XG4gICAgICAgIEBjdXJyZW50VGltZXMoKVxuICAgICAgICBpZiBAY29sbGVjdGlvbi5sZW5ndGhcbiAgICAgICAgICAgIEAkZWwuZmluZCgnLnJlc3VsdHMnKS5zaG93KCkuZmluZCgndGJvZHknKS5lbXB0eSgpXG4gICAgICAgICAgICBAJGVsLmZpbmQoJy5lbXB0eScpLmhpZGUoKVxuICAgICAgICAgICAgQGNvbGxlY3Rpb24uZWFjaCBAYWRkT25lVGltZVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAJGVsLmZpbmQoJy5yZXN1bHRzJykuaGlkZSgpXG4gICAgICAgICAgICBAJGVsLmZpbmQoJy5lbXB0eScpLnNob3coKVxuICAgICAgICBAXG5cbiAgICBhZGRPbmVUaW1lIDogKHRpbWUpIC0+XG4gICAgICAgIHRpbWVzVmlldyA9IEBcbiAgICAgICAgdmlldyA9IG5ldyBUSU1FVFJBQ0tFUi5UaW1lVmlldyB7bW9kZWw6IHRpbWV9XG4gICAgICAgIHZpZXcub24gJ2Rlc3Ryb3k6dGltZSB1cGRhdGU6dGltZScsIC0+XG4gICAgICAgICAgICB0aW1lc1ZpZXcudHJpZ2dlciAndXBkYXRlOnRpbWVzJ1xuICAgICAgICBAJGVsLmZpbmQoJy5yZXN1bHRzIHRib2R5JykuYXBwZW5kIHZpZXcucmVuZGVyKCkuJGVsXG4gICAgICAgIG51bGxcblxuICAgIGN1cnJlbnRUaW1lcyA6IC0+XG4gICAgICAgIEBjb2xsZWN0aW9uID0gVElNRVRSQUNLRVIuRGF0YS5maW5kV2hlcmUoe2N1cnJlbnQ6dHJ1ZX0pLmdldCgndGltZXMnKVxufVxuXG5cblRJTUVUUkFDS0VSLlByb2plY3RNb2RlbCA9IEJhY2tib25lLk1vZGVsLmV4dGVuZCB7XG4gICAgZGVmYXVsdHMgOiB7XG4gICAgICAgIGN1cnJlbnQgOiBmYWxzZVxuICAgICAgICB0aW1lcyA6IFtdXG4gICAgfVxuXG4gICAgYXNEaWN0IDogLT5cbiAgICAgICAge1xuICAgICAgICAgICAgc2VsZWN0ZWQgOiBpZiBAZ2V0ICdjdXJyZW50JyB0aGVuICdzZWxlY3RlZCcgZWxzZSAnJ1xuICAgICAgICAgICAgbmFtZSA6IEBnZXQgJ25hbWUnXG4gICAgICAgIH1cbn1cblxuXG5USU1FVFJBQ0tFUi5Qcm9qZWN0c0NvbGxlY3Rpb24gPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCB7XG4gICAgbW9kZWwgOiBUSU1FVFJBQ0tFUi5Qcm9qZWN0TW9kZWxcbn1cblxuXG5USU1FVFJBQ0tFUi5Qcm9qZWN0VmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kIHtcblxuICAgIHRhZ05hbWUgOiAnb3B0aW9uJ1xuXG4gICAgaW5pdGlhbGl6ZSA6IC0+XG4gICAgICAgIF8uYmluZEFsbCBALCAncmVuZGVyJ1xuXG4gICAgcmVuZGVyIDogLT5cbiAgICAgICAgbmFtZSA9IEBtb2RlbC5nZXQgJ25hbWUnXG4gICAgICAgIEAkZWwudGV4dChuYW1lKS52YWwobmFtZSkuYXR0ciAnc2VsZWN0ZWQnLCBAbW9kZWwuZ2V0ICdjdXJyZW50J1xuICAgICAgICBAXG59XG5cblxuVElNRVRSQUNLRVIuUHJvamVjdHNWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQge1xuXG4gICAgZWwgOiAkICdzZWxlY3Quc2VsZWN0LXByb2plY3QnXG5cbiAgICBldmVudHMgOiB7XG4gICAgICAgICdjaGFuZ2UnIDogJ3NlbGVjdFByb2plY3QnXG4gICAgICAgICdjbGljaycgIDogJ2NsaWNrU2VsZWN0UHJvamVjdCdcbiAgICB9XG5cbiAgICBpbml0aWFsaXplIDogLT5cbiAgICAgICAgXy5iaW5kQWxsIEAsICdyZW5kZXInLCAnYWRkT25lUHJvamVjdCcsICdzZWxlY3RQcm9qZWN0JywgJ2NsaWNrU2VsZWN0UHJvamVjdCdcbiAgICAgICAgQGNvbGxlY3Rpb24gPSBUSU1FVFJBQ0tFUi5EYXRhXG5cbiAgICByZW5kZXIgOiAtPlxuICAgICAgICBAJGVsLmVtcHR5KClcbiAgICAgICAgaWYgQGNvbGxlY3Rpb24ubGVuZ3RoXG4gICAgICAgICAgICBAY29sbGVjdGlvbi5lYWNoIEBhZGRPbmVQcm9qZWN0XG4gICAgICAgIEBcblxuICAgIGFkZE9uZVByb2plY3QgOiAocHJvamVjdCkgLT5cbiAgICAgICAgdmlldyA9IG5ldyBUSU1FVFJBQ0tFUi5Qcm9qZWN0VmlldyB7bW9kZWw6IHByb2plY3R9XG4gICAgICAgIEAkZWwuYXBwZW5kIHZpZXcucmVuZGVyKCkuJGVsXG4gICAgICAgIG51bGxcblxuICAgIHNlbGVjdFByb2plY3QgOiAoZSkgLT5cbiAgICAgICAgaWYgJCgnI2NvbnRlbnQtd3JhcHBlcicpLmhhc0NsYXNzICdsb2NrJ1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQndC10LvRjNC30Y8g0LLRi9Cx0YDQsNGC0Ywg0L/RgNC+0LXQutGCINC/0L7QutCwINGA0LDQsdC+0YLQsNC10YIg0YLQsNC50LzQtdGAJ1xuICAgICAgICB2YWx1ZSA9IEAkZWwudmFsKClcbiAgICAgICAgY29sbGVjdGlvbiA9IEBjb2xsZWN0aW9uXG4gICAgICAgIGNvbGxlY3Rpb24uZm9yRWFjaCAobW9kZWwpIC0+XG4gICAgICAgICAgICBtb2RlbC5zZXQgJ2N1cnJlbnQnLCB2YWx1ZSA9PSBtb2RlbC5nZXQgJ25hbWUnXG4gICAgICAgIGNvbGxlY3Rpb24udHJpZ2dlciAndG9nZ2xlJ1xuICAgICAgICBUSU1FVFJBQ0tFUi50b2dnbGVQcm9qZWN0U2VsZWN0TGlzdCgpXG4gICAgICAgIG51bGxcblxuICAgIGNsaWNrU2VsZWN0UHJvamVjdCA6IChlKSAtPlxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgIGlmICQoJyNjb250ZW50LXdyYXBwZXInKS5oYXNDbGFzcyAnbG9jaydcbiAgICAgICAgICAgIHJldHVybiBhbGVydCAn0J3QtdC70YzQt9GPLCDQv9C+0LrQsCDRgNCw0LHQvtGC0LDQtdGCINGC0LDQudC80LXRgCdcbiAgICAgICAgbnVsbFxuXG59XG5cblxuVElNRVRSQUNLRVIuVGl0bGVWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQge1xuXG4gICAgZWwgOiAkICcudGl0bGUtY29udGFpbmVyJ1xuXG4gICAgZXZlbnRzIDoge1xuICAgICAgICAnY2xpY2sgICAuc3dhcC1wcm9qZWN0JyA6ICdzd2FwUHJvamVjdCdcbiAgICAgICAgJ2NsaWNrICAgIC5hZGQtcHJvamVjdCcgOiAnYWRkUHJvamVjdCdcbiAgICAgICAgJ2NsaWNrIC5yZW1vdmUtcHJvamVjdCcgOiAncmVtb3ZlUHJvamVjdCdcbiAgICB9XG5cbiAgICBpbml0aWFsaXplIDogLT5cbiAgICAgICAgXy5iaW5kQWxsIEAsICdyZW5kZXInLCAnc3dhcFByb2plY3QnLCAnYWRkUHJvamVjdCcsICdyZW1vdmVQcm9qZWN0JyxcbiAgICAgICAgICAgICdjbG9zZVNlbGVjdFByb2plY3QnXG4gICAgICAgICQod2luZG93KS5vbiAnY2xpY2snLCBAY2xvc2VTZWxlY3RQcm9qZWN0XG4gICAgICAgIEBjb2xsZWN0aW9uID0gVElNRVRSQUNLRVIuRGF0YVxuICAgICAgICBAcHJvamVjdHNWaWV3ID0gbmV3IFRJTUVUUkFDS0VSLlByb2plY3RzVmlldygpXG5cbiAgICByZW5kZXIgOiAtPlxuICAgICAgICBjdXJyZW50ID0gVElNRVRSQUNLRVIuRGF0YS5maW5kV2hlcmUge2N1cnJlbnQ6dHJ1ZX1cbiAgICAgICAgQCRlbC5maW5kKCcucHJvamVjdC1uYW1lJykudGV4dCBcIiDigJQgI3tjdXJyZW50LmdldCgnbmFtZScpfVwiXG4gICAgICAgIEBwcm9qZWN0c1ZpZXcucmVuZGVyKClcbiAgICAgICAgQFxuXG4gICAgc3dhcFByb2plY3QgOiAoZSkgLT5cbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgaWYgJCgnI2NvbnRlbnQtd3JhcHBlcicpLmhhc0NsYXNzICdsb2NrJ1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQndC10LvRjNC30Y8g0L/QtdGA0LXQutC70Y7Rh9C40YLRjCDQv9GA0L7QtdC60YIg0L/QvtC60LAg0YDQsNCx0L7RgtCw0LXRgiDRgtCw0LnQvNC10YAnXG4gICAgICAgIFRJTUVUUkFDS0VSLnRvZ2dsZVByb2plY3RTZWxlY3RMaXN0KClcbiAgICAgICAgbnVsbFxuXG4gICAgYWRkUHJvamVjdCA6IChlKSAtPlxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgaWYgJCgnI2NvbnRlbnQtd3JhcHBlcicpLmhhc0NsYXNzICdsb2NrJ1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQndC10LvRjNC30Y8g0LTQvtCx0LDQstC40YLRjCDQv9GA0L7QtdC60YIg0L/QvtC60LAg0YDQsNCx0L7RgtCw0LXRgiDRgtCw0LnQvNC10YAnXG4gICAgICAgIHRpdGxlID0gcHJvbXB0ICfQktCy0LXQtNC40YLQtSDQvdCw0LfQstCw0L3QuNC1INC90L7QstC+0LPQviDQv9GA0L7QtdC60YLQsDonXG4gICAgICAgIHRpdGxlID0gJC50cmltKHRpdGxlIG9yICcnKVxuICAgICAgICBpZiBub3QgdGl0bGVcbiAgICAgICAgICAgIHJldHVybiBhbGVydCAn0JLRiyDQvdC1INCy0LLQtdC70Lgg0L3QsNC30LLQsNC90LjQtSDQv9GA0L7QtdC60YLQsCdcbiAgICAgICAgaWYgQGNvbGxlY3Rpb24ucGx1Y2soJ25hbWUnKS5pbmRleE9mKHRpdGxlKSAhPSAtMVxuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQotCw0LrQvtC5INC/0YDQvtC10LrRgiDRg9C20LUg0YHRg9GJ0LXRgdGC0LLRg9C10YInXG4gICAgICAgIEBjb2xsZWN0aW9uLmZvckVhY2ggKG1vZGVsKSAtPlxuICAgICAgICAgICAgbW9kZWwuc2V0ICdjdXJyZW50JywgZmFsc2VcbiAgICAgICAgQGNvbGxlY3Rpb24uYWRkIHtcbiAgICAgICAgICAgIG5hbWUgOiB0aXRsZVxuICAgICAgICAgICAgY3VycmVudCA6IHRydWVcbiAgICAgICAgICAgIHRpbWVzIDogbmV3IFRJTUVUUkFDS0VSLlRpbWVzQ29sbGVjdGlvblxuICAgICAgICB9XG4gICAgICAgIEBjb2xsZWN0aW9uLnRyaWdnZXIgJ3RvZ2dsZSdcbiAgICAgICAgbnVsbFxuXG4gICAgcmVtb3ZlUHJvamVjdCA6IChlKSAtPlxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgaWYgJCgnI2NvbnRlbnQtd3JhcHBlcicpLmhhc0NsYXNzICdsb2NrJ1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQndC10LvRjNC30Y8g0YPQtNCw0LvQuNGC0Ywg0L/RgNC+0LXQutGCINC/0L7QutCwINGA0LDQsdC+0YLQsNC10YIg0YLQsNC50LzQtdGAJ1xuICAgICAgICBpZiBub3QgY29uZmlybSAn0JLRiyDQtNC10LnRgdGC0LLQuNGC0LXQu9GM0L3QviDRhdC+0YLQuNGC0LUg0JHQldCX0JLQntCX0JLQoNCQ0KLQndCeINGD0LTQsNC70LjRgtGMINC/0YDQvtC10LrRgj8nXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgY3VycmVudCA9IEBjb2xsZWN0aW9uLmZpbmRXaGVyZSh7Y3VycmVudDp0cnVlfSlcbiAgICAgICAgaWYgJ0RlZmF1bHQnID09IGN1cnJlbnQuZ2V0ICduYW1lJ1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0ICfQndC10LvRjNC30Y8g0YPQtNCw0LvQuNGC0Ywg0L/RgNC+0LXQutGCIGBEZWZhdWx0YCdcbiAgICAgICAgQGNvbGxlY3Rpb24ucmVtb3ZlIGN1cnJlbnRcbiAgICAgICAgQGNvbGxlY3Rpb24uZm9yRWFjaCAobW9kZWwpIC0+XG4gICAgICAgICAgICBtb2RlbC5zZXQgJ2N1cnJlbnQnLCAnRGVmYXVsdCcgPT0gbW9kZWwuZ2V0ICduYW1lJ1xuICAgICAgICBAY29sbGVjdGlvbi50cmlnZ2VyICd0b2dnbGUnXG4gICAgICAgIG51bGxcblxuICAgIGNsb3NlU2VsZWN0UHJvamVjdCA6IChlKSAtPlxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgIGlmICQoJy5zZWxlY3QtcHJvamVjdCcpLmlzKCc6dmlzaWJsZScpIGFuZCBub3QgJChlLnRhcmdldCkuaGFzQ2xhc3MoJ3NlbGVjdC1wcm9qZWN0JylcbiAgICAgICAgICAgIFRJTUVUUkFDS0VSLnRvZ2dsZVByb2plY3RTZWxlY3RMaXN0KClcbiAgICAgICAgbnVsbFxuXG59XG5cblxuVElNRVRSQUNLRVIuVGltZXJWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQge1xuXG4gICAgZWwgOiAkICcudGltZXItY29udGFpbmVyJ1xuXG4gICAgZXZlbnRzIDoge1xuICAgICAgICAnY2xpY2sgYS5sYWJlbCcgOiAndG9nZ2xlVGltZXInXG4gICAgICAgICdjbGljayBhLmJ0bicgICA6ICd0b2dnbGVUaW1lcidcbiAgICB9XG5cbiAgICBpbml0aWFsaXplIDogLT5cbiAgICAgICAgQGNhbGNUb3RhbCgpXG4gICAgICAgIEBtb2RlbCA9IG51bGxcbiAgICAgICAgQHRpbWVyRWwgPSBAJGVsLmZpbmQgJ2EubGFiZWwnXG4gICAgICAgIEBidG5FbCA9IEAkZWwuZmluZCAnaS5mYSdcbiAgICAgICAgQHRvdGFsRWwgPSBAJGVsLmZpbmQoJy50b3RhbC10aW1lIC50b3RhbC52YWx1ZScpLnRleHQgVElNRVRSQUNLRVIuZm9ybWF0TWlsbGlzZWNvbmRzKEB0b3RhbClcbiAgICAgICAgQG9wZW5lZEVsID0gQCRlbC5maW5kKCcudG90YWwtdGltZSAub3BlbmVkLnZhbHVlJykudGV4dCBUSU1FVFJBQ0tFUi5mb3JtYXRNaWxsaXNlY29uZHMoQG9wZW5lZClcbiAgICAgICAgXy5iaW5kQWxsIEAsICdyZW5kZXInLCAndG9nZ2xlVGltZXInLCAnc3luY0NvbGxlY3Rpb24nLCAnY2FsY1RvdGFsJ1xuXG4gICAgcmVuZGVyIDogLT5cbiAgICAgICAgQGxvb3BDb3VudGVyICs9IDFcbiAgICAgICAgZm9ybWF0ID0gVElNRVRSQUNLRVIuZm9ybWF0TWlsbGlzZWNvbmRzXG4gICAgICAgIGlmIEBtb2RlbFxuICAgICAgICAgICAgZW5kVHMgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgICAgICAgZGlmZiA9IGVuZFRzIC0gQG1vZGVsLmdldCAnc3RhcnRUcydcbiAgICAgICAgICAgIEB0aW1lckVsLnRleHQgZm9ybWF0KGRpZmYpXG4gICAgICAgICAgICBAdG90YWxFbC50ZXh0IGZvcm1hdChkaWZmICsgQHRvdGFsKVxuICAgICAgICAgICAgQG9wZW5lZEVsLnRleHQgZm9ybWF0KGRpZmYgKyBAb3BlbmVkKVxuICAgICAgICAgICAgI2lmIEBsb29wQ291bnRlciAlIDEwMCBpcyAwICMgcGVyIDUgc2Vjb25kc1xuICAgICAgICAgICAgIyAgICBAbW9kZWwuc2V0ICdlbmRUcycsIGVuZFRzXG4gICAgICAgICAgICBAbW9kZWwuc2V0ICdlbmRUcycsIGVuZFRzXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgQHJlbmRlclxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAY2FsY1RvdGFsKClcbiAgICAgICAgICAgIEB0b3RhbEVsLnRleHQgZm9ybWF0KEB0b3RhbClcbiAgICAgICAgICAgIEBvcGVuZWRFbC50ZXh0IGZvcm1hdChAb3BlbmVkKVxuICAgICAgICBAXG5cbiAgICB0b2dnbGVUaW1lciA6IChlKSAtPlxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgJCgnI2NvbnRlbnQtd3JhcHBlcicpLnRvZ2dsZUNsYXNzICdsb2NrJ1xuICAgICAgICBpZiBAbW9kZWxcbiAgICAgICAgICAgIEBidG5FbC5yZW1vdmVDbGFzcygnZmEtcGF1c2UnKS5hZGRDbGFzcygnZmEtcGxheScpXG4gICAgICAgICAgICBAbW9kZWwudW5iaW5kICdjaGFuZ2UnLCBAc3luY0NvbGxlY3Rpb25cbiAgICAgICAgICAgIEBtb2RlbCA9IG51bGxcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQGJ0bkVsLnJlbW92ZUNsYXNzKCdmYS1wbGF5JykuYWRkQ2xhc3MoJ2ZhLXBhdXNlJylcbiAgICAgICAgICAgIEBsb29wQ291bnRlciA9IDBcbiAgICAgICAgICAgIHRzID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgICAgICAgIEBtb2RlbCA9IG5ldyBUSU1FVFJBQ0tFUi5UaW1lTW9kZWwge1xuICAgICAgICAgICAgICAgIHN0YXJ0VHMgOiB0cyxcbiAgICAgICAgICAgICAgICBlbmRUcyA6IHRzLFxuICAgICAgICAgICAgICAgIGRlc2MgOiAocHJvbXB0KCfQnNC+0LbQtdGC0LUg0LLQstC10YHRgtC4INC/0L7Rj9GB0L3QtdC90LjQtTonKSB8fCAnJykudHJpbSgpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQG1vZGVsLmJpbmQgJ2NoYW5nZScsIEBzeW5jQ29sbGVjdGlvblxuICAgICAgICAgICAgQGNvbGxlY3Rpb24gPSBUSU1FVFJBQ0tFUi5EYXRhLmZpbmRXaGVyZSh7Y3VycmVudDp0cnVlfSlcbiAgICAgICAgICAgIEBjb2xsZWN0aW9uLmdldCgndGltZXMnKS51bnNoaWZ0IEBtb2RlbFxuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIEByZW5kZXJcbiAgICAgICAgQHRyaWdnZXIgJ3VwZGF0ZTpwZXJpb2RpYydcbiAgICAgICAgbnVsbFxuXG4gICAgc3luY0NvbGxlY3Rpb24gOiAoKSAtPlxuICAgICAgICBpZiBAbW9kZWxcbiAgICAgICAgICAgIEJhY2tib25lLnN5bmMgJ3VwZGF0ZScsIFRJTUVUUkFDS0VSLkRhdGFcblxuICAgIGNhbGNUb3RhbCA6IC0+XG4gICAgICAgIEBjb2xsZWN0aW9uID0gVElNRVRSQUNLRVIuRGF0YS5maW5kV2hlcmUoe2N1cnJlbnQ6dHJ1ZX0pXG4gICAgICAgIEB0b3RhbCA9IEBjb2xsZWN0aW9uLmdldCgndGltZXMnKS5yZWR1Y2UoKHByZXYsIG1vZGVsKSAtPlxuICAgICAgICAgICAgcHJldiArIG1vZGVsLmRpZmYoKVxuICAgICAgICAsIDApXG4gICAgICAgIEBvcGVuZWQgPSBAY29sbGVjdGlvbi5nZXQoJ3RpbWVzJykucmVkdWNlKChwcmV2LCBtb2RlbCkgLT5cbiAgICAgICAgICAgIHByZXYgKyAoaWYgbW9kZWwuZ2V0ICdjbG9zZWQnIHRoZW4gMCBlbHNlIG1vZGVsLmRpZmYoKSlcbiAgICAgICAgLCAwKVxuXG59XG5cblxuVElNRVRSQUNLRVIuQXBwVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kIHtcblxuICAgIGlkIDogJ2NvbnRlbnQtd3JhcHBlcidcblxuICAgIGluaXRpYWxpemUgOiAtPlxuICAgICAgICBfLmJpbmRBbGwgQCwgJ3JlbmRlcidcbiAgICAgICAgVElNRVRSQUNLRVIuRGF0YSA9IG5ldyBUSU1FVFJBQ0tFUi5Qcm9qZWN0c0NvbGxlY3Rpb24oKVxuICAgICAgICBUSU1FVFJBQ0tFUi5EYXRhLmZldGNoKClcbiAgICAgICAgVElNRVRSQUNLRVIuRGF0YS5vbiAndG9nZ2xlJywgLT5cbiAgICAgICAgICAgIEJhY2tib25lLnN5bmMgJ3VwZGF0ZScsIFRJTUVUUkFDS0VSLkRhdGEsIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzIDogQHJlbmRlclxuICAgICAgICAgICAgfVxuICAgICAgICAsIEBcbiAgICAgICAgQHRpdGxlVmlldyA9IG5ldyBUSU1FVFJBQ0tFUi5UaXRsZVZpZXcoKVxuICAgICAgICBAdGltZXJWaWV3ID0gbmV3IFRJTUVUUkFDS0VSLlRpbWVyVmlldygpXG4gICAgICAgIEB0aW1lc1ZpZXcgPSBuZXcgVElNRVRSQUNLRVIuVGltZXNWaWV3KClcbiAgICAgICAgQHRpbWVzVmlldy5vbiAndXBkYXRlOnRpbWVzJywgQHRpbWVyVmlldy5yZW5kZXJcbiAgICAgICAgQHRpbWVyVmlldy5vbiAndXBkYXRlOnBlcmlvZGljJywgQHRpbWVzVmlldy5yZW5kZXJcbiAgICAgICAgQHJlbmRlcigpXG5cbiAgICByZW5kZXIgOiAtPlxuICAgICAgICBAdGl0bGVWaWV3LnJlbmRlcigpXG4gICAgICAgIEB0aW1lclZpZXcucmVuZGVyKClcbiAgICAgICAgQHRpbWVzVmlldy5yZW5kZXIoKVxuICAgICAgICBAXG5cbn1cblxuXG53aW5kb3cub25sb2FkID0gLT5cbiAgICBuZXcgVElNRVRSQUNLRVIuQXBwVmlldygpXG4iXX0=
